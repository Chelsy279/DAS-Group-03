setwd("D:/UOFG/Semester 2/Data Analysis Skill/Group Project 2/DAS-Group-03")
# Read the data set
Data_FIES <- read.csv("dataset03.csv")
# Tidy the data
FIES <- Data_FIES %>%
# Place the dependent variable in the first column and delete the unique value
select(Total.Number.of.Family.members, everything(), -Region) %>%
# Convert categorical variables into factors
mutate(
Household.Head.Sex = as.factor(Household.Head.Sex),
Type.of.Household = as.factor(Type.of.Household),
Electricity = as.factor(Electricity)) %>%
# Remove Missing Values
drop_na()
library(ggplot2)
library(GGally)
library(tidyverse)
library(dplyr)
library(gt)
library(patchwork)
library(gridExtra)
library(moderndive)
# Read the data set
Data_FIES <- read.csv("dataset03.csv")
# Tidy the data
FIES <- Data_FIES %>%
# Place the dependent variable in the first column and delete the unique value
select(Total.Number.of.Family.members, everything(), -Region) %>%
# Convert categorical variables into factors
mutate(
Household.Head.Sex = as.factor(Household.Head.Sex),
Type.of.Household = as.factor(Type.of.Household),
Electricity = as.factor(Electricity)) %>%
# Remove Missing Values
drop_na()
str(FIES) # Check data structure
summary(FIES) # Get summary statistics of all variables
dim(FIES) # Check dataset dimensions (number of rows and columns)
# Compute mean and variance of the dependent variable
mean <- mean(FIES$Total.Number.of.Family.members)
var <- var(FIES$Total.Number.of.Family.members)
var_ratio <- var/mean
# var/mean=5.28/4.68=1.13â‰ˆ1 indicates that there is no overdispersion problem, so Poisson regression model may be appropriate.
# Tables of summary statistics
FIES |>
summarize('Mean' = mean(Total.Household.Income),
'Median' = median(Total.Household.Income),
'St.Dev' = sd(Total.Household.Income),
'Min' = min(Total.Household.Income),
'Max' = max(Total.Household.Income),
'IQR' = quantile(Total.Household.Income,0.75)-quantile(Total.Household.Income,0.25),
'Sample_size' = n()
) |>
gt() |>
fmt_number(decimals=2) |>
cols_label(
Mean = html("Mean"),
Median = html("Median"),
St.Dev = html("Std. Dev"),
Min = html("Minimum"),
Max = html("Maximum"),
IQR = html("Interquartile Range"),
Sample_size = html("Sample Size")
) |>
tab_header(
title = md("Table 1: Summary statistics on Total Household Income")
)|>
tab_options(
table.border.top.style = "none"
)
FIES |>
summarize('Mean' = mean(Total.Household.Income),
'Median' = median(Total.Household.Income),
'St.Dev' = sd(Total.Household.Income),
'Min' = min(Total.Household.Income),
'Max' = max(Total.Household.Income),
'IQR' = quantile(Total.Household.Income,0.75)-quantile(Total.Household.Income,0.25),
'Sample_size' = n(),
.by = Household.Head.Sex) |>
gt() |>
fmt_number(decimals=2) |>
cols_label(
Mean = html("Mean"),
Median = html("Median"),
St.Dev = html("Std. Dev"),
Min = html("Minimum"),
Max = html("Maximum"),
IQR = html("Interquartile Range"),
Sample_size = html("Sample Size")
)|>
tab_header(
title = md("Table 2: Summary statistics on Total.Household.Income by Household.Head.Sex with appropriate comments")
)|>
tab_options(
table.border.top.style = "none"
)
FIES |>
summarize('Mean' = mean(Total.Household.Income),
'Median' = median(Total.Household.Income),
'St.Dev' = sd(Total.Household.Income),
'Min' = min(Total.Household.Income),
'Max' = max(Total.Household.Income),
'IQR' = quantile(Total.Household.Income,0.75)-quantile(Total.Household.Income,0.25),
'Sample_size' = n(),
.by = Household.Head.Sex) |>
gt() |>
fmt_number(decimals=2) |>
cols_label(
Mean = html("Mean"),
Median = html("Median"),
St.Dev = html("Std. Dev"),
Min = html("Minimum"),
Max = html("Maximum"),
IQR = html("Interquartile Range"),
Sample_size = html("Sample Size")
)|>
tab_header(
title = md("Table 2: Summary statistics on Total.Household.Income by Household.Head.Sex with appropriate comments")
)|>
tab_options(
table.border.top.style = "none"
)
FIES |>
summarize('Mean' = mean(Total.Household.Income),
'Median' = median(Total.Household.Income),
'St.Dev' = sd(Total.Household.Income),
'Min' = min(Total.Household.Income),
'Max' = max(Total.Household.Income),
'IQR' = quantile(Total.Household.Income,0.75)-quantile(Total.Household.Income,0.25),
'Sample_size' = n(),
.by = Type.of.Household) |>
gt() |>
fmt_number(decimals=2) |>
cols_label(
Mean = html("Mean"),
Median = html("Median"),
St.Dev = html("Std. Dev"),
Min = html("Minimum"),
Max = html("Maximum"),
IQR = html("Interquartile Range"),
Sample_size = html("Sample Size")
)|>
tab_header(
title = md("Table 3: Summary statistics on Total.Household.Income by Type.of.Household with appropriate comments")
)|>
tab_options(
table.border.top.style = "none"
)
#
FIES |>
summarize('Mean' = mean(Total.Household.Income),
'Median' = median(Total.Household.Income),
'St.Dev' = sd(Total.Household.Income),
'Min' = min(Total.Household.Income),
'Max' = max(Total.Household.Income),
'IQR' = quantile(Total.Household.Income,0.75)-quantile(Total.Household.Income,0.25),
'Sample_size' = n(),
.by = Electricity) |>
gt() |>
fmt_number(decimals=2) |>
cols_label(
Mean = html("Mean"),
Median = html("Median"),
St.Dev = html("Std. Dev"),
Min = html("Minimum"),
Max = html("Maximum"),
IQR = html("Interquartile Range"),
Sample_size = html("Sample Size")
)|>
tab_header(
title = md("Table 4: Summary statistics on Total.Household.Income by Electricity with appropriate comments")
)|>
tab_options(
table.border.top.style = "none"
)
# Boxplots for Categorical explanatory variables
ggplot(FIES, aes(x = Household.Head.Sex, y = Total.Number.of.Family.members, fill = Household.Head.Sex)) +
geom_boxplot() +
labs(title = "Family Size by Household Head's Gender", x = "Household Head's Gender", y = "Family Size")
ggplot(FIES, aes(x = Type.of.Household, y = Total.Number.of.Family.members, fill = Type.of.Household)) +
geom_boxplot() +
labs(title = "Family Size by Household Type", x = "Household Type", y = "Family Size")
ggplot(FIES, aes(x = Electricity, y = Total.Number.of.Family.members, fill = Electricity)) +
geom_boxplot() +
labs(title = "Family Size by Electricity Access", x = "Electricity (0 = No, 1 = Yes)", y = "Family Size")
# Compute Correlation Matrix and Scatterplot Matrix
numeric_vars <- select(FIES,where(is.numeric))
cor_matrix <- cor(numeric_vars)
print(cor_matrix)
ggpairs(numeric_vars)
# Fit a Poisson regression model
poisson_model <- glm(Total.Number.of.Family.members ~
Total.Household.Income +
Total.Food.Expenditure +
Household.Head.Age +
House.Floor.Area +
House.Age +
Number.of.bedrooms +
Household.Head.Sex +
Type.of.Household +
Electricity,
family = poisson(link = "log"),
data = FIES)
summary(poisson_model)
# Check the Relative Risk(RR)
exp(coef(poisson_model))
# For Poission Regression, coefficients represent log-relative risk, so convert them to RR
# plot the Pearson and deviance residuals against the linear predictor
resp <- resid(poisson_model, type = "pearson")
resd <- resid(poisson_model, type = "deviance")
p1 <- ggplot(poisson_model, aes(sample = resp)) + geom_point(stat = "qq", color = "steelblue") +
ylab("Pearson residuals")
p2 <- ggplot(poisson_model, aes(sample = resd)) + geom_point(stat = "qq", color = "steelblue") +
ylab("Deviance residuals")
p3 <- ggplot(poisson_model, aes(x = predict(poisson_model, type="link"), y =resp))+
geom_point(col = "steelblue") +
ylab("Pearson residuals") + xlab("Linear predictor")
p4 <- ggplot(poisson_model, aes(x = predict(poisson_model, type="link"), y =resd))+
geom_point(col = "steelblue") +
ylab("Deviance residuals") + xlab("Linear predictor")
grid.arrange(p1, p2, p3, p4, nrow = 2)
